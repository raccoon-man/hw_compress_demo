# 一、问题说明

1. 此代码按照基数（数据唯一值数量）处理三种不同的列，基数为1的列，基数大于1小于50的列和基数大于50的列，基数数量适中的列通过字典处理，而基数大于50的列又会经过不同的处理

2. 处理后的列拼接在一起，以binary的数据结构存入parquet中

3. 结果数据如下：
   CSV 文件大小: 814752 字节
   Parquet 文件大小: 269916 字节
   Parquet压缩率: 0.33128608459997644
   压缩后 Parquet 文件大小: 101962 字节
   压缩后压到Parquet压缩率: 0.1251448293468442
   压缩后字典json大小: 1586字节

# 二、程序文件结构说明

- 文件结构图如下：
  
  ![](C:\Users\11390\AppData\Roaming\marktext\images\2024-08-24-11-31-32-image.png)city0存每一列处理后的csv文件

- data文件夹存原始的parquet文件

- json文件夹存字典压缩产生的字典json数据

- city0_*为前缀的csv文件为大整数列，经过预处理得到的中间csv文件数据

- city0-4G-1M-compress.parquet为处理后存入parquet的文件

- city0-4G-1M-compress.csv为处理后生成的csv文件

- exact为程序运行代码 程序运行环境为Python 3.7.7
